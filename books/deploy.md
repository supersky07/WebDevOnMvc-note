# 部署

========

## 性能

提高性能，最简单的也是最显著的方法就是：减少HTTP请求的数量。每一个HTTP请求除了有TCP开销以外，还包含了大量的头信息。

减少请求的方式有很多，常见的就是将多个脚本合并成一个脚本文件，或将多个CSS合成一个样式表，再将图片拼成CSS Sprites，然后使用background-image和background-position属性在一诶按中显示对应的图片。

避免重定向也是减少请求的一个方法，一般URL后面的/不应该被省略，它会导致重定向。

## 缓存

将静态资源设置Expires头来设置缓存失效时间。

	Expires: Thu, 20 March 2015 00:00:00 GMT

HTTP1.1引入了Cache-Control头，它带来了更高级的缓存，同时还弥补了Expires的不足。Cache-Control的控制头信息有很多选项，可用逗号分隔：

	Cache-Control: max-age=3600, must-revalidate

以下为Cache-Control可能会用到的选项：

- max-age
	- 以秒为单位，指定资源的最大有效时间
- public
	- 标记资源是可被缓存的
- no-store
	- 完全关闭缓存，动态内容才会更多的使用这个选项
- must-revalidate
	- 告诉缓存它们必须遵循任何你给定的信息，并基于这些信息来判断资源的新旧程度。

给提供服务的资源增加Last-Modified头信息也有助于缓存。浏览器在对该资源后续的请求中，就能指定If-Modified-Since头信息，这是一个时间戳，用来判断缓存是否已更新。若未更新，则直接返回304状态码，浏览器仍然可以请求，但不会返回具体内容，会从浏览器缓存中读取。

Last-Modified的替代方式是Etag。比较Etag就像比较两个文件的hash值，请求头中带的If-None-Match与服务器端的Etag比较，若不同证明资源已更新，否则返回304状态码。

Etaf通常是使用服务器指定的一些属性来构建——也就是说，两个独立的服务器对同样的资源生成的Etag可能不一样——随着服务器集群越来越普遍，这成为一个现实的问题。当然当前也已经有很成熟的解决方案。

## 源码压缩



